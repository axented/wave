(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{"+dKP":function(t,e,r){"use strict";r.r(e),r.d(e,"EstimatesModule",function(){return Q});var a=r("ofXK"),i=r("1kSV"),o=r("njyG"),c=r("tyNb"),s=r("3Pt+"),b=r("5eHb");class d{constructor(t){this.id=t.id,this.amount=t.amount,this.customer=t.customer,this.estimateDate=t.estimateDate,this.expiryDate=t.expiryDate,this.number=t.number,this.ownerId=t.ownerId,this.products=t.products,this.refNumber=t.refNumber,this.status=t.status}}var n=r("Kj3r"),m=r("/uUt"),u=r("lJxs"),l=r("fXoL"),p=r("UbJi"),h=r("T/S4");function f(t,e){if(1&t&&(l.Ub(0,"option",24),l.Dc(1),l.Tb()),2&t){const t=l.gc();l.nc("value",t.customer),l.Db(1),l.Ec(t.customer.name)}}function g(t,e){if(1&t&&(l.Ub(0,"option",25),l.Dc(1),l.Tb()),2&t){const t=e.$implicit;l.mc("ngValue",t),l.Db(1),l.Ec(t.name)}}function v(t,e){if(1&t){const t=l.Vb();l.Ub(0,"i",35),l.ec("click",function(){l.vc(t);const e=l.gc().index;return l.gc().removeProduct(e)}),l.Tb()}}function T(t,e){if(1&t){const t=l.Vb();l.Ub(0,"tr",26),l.Sb(1,27),l.Ub(2,"td"),l.Ub(3,"input",28),l.ec("selectItem",function(r){l.vc(t);const a=e.$implicit;return l.gc().selectedProduct(r,a)}),l.Tb(),l.Tb(),l.Ub(4,"td"),l.Qb(5,"input",29),l.Tb(),l.Ub(6,"td"),l.Qb(7,"input",30),l.Tb(),l.Ub(8,"td"),l.Dc(9),l.Tb(),l.Ub(10,"td"),l.Qb(11,"input",31),l.Tb(),l.Ub(12,"td",32),l.Ub(13,"i",33),l.ec("click",function(){return l.vc(t),l.gc().addProduct()}),l.Tb(),l.Bc(14,v,1,0,"i",34),l.Tb(),l.Rb(),l.Tb()}if(2&t){const t=e.index,r=l.gc();l.Db(1),l.mc("formGroupName",t),l.Db(2),l.mc("resultFormatter",r.formatMatches)("inputFormatter",r.formatMatches)("ngbTypeahead",r.search),l.Db(6),l.Fc(" ","+ "+r.tax+"%"," "),l.Db(2),l.nc("value",r.getAmount(t)),l.Db(3),l.mc("ngIf",r.estimateForm.get("products").value.length>1)}}let U=(()=>{class t{constructor(t,e,r,a,i){this.activeModal=t,this.auth=e,this.fb=r,this.firestoreService=a,this.toastr=i,this.customers=[],this.estimateForm=this.fb.group({customer:["",s.t.required],fromDate:["",s.t.required],products:this.fb.array([this.createProduct()]),number:["",s.t.required],refNumber:["",s.t.required],toDate:["",s.t.required]}),this.formatMatches=t=>t.name||"",this.productsForm=this.fb.array([]),this.products=[],this.search=t=>t.pipe(Object(n.a)(200),Object(m.a)(),Object(u.a)(t=>t.length<2?[]:this.products.filter(e=>e.name.toLowerCase().indexOf(t.toLowerCase())>-1).slice(0,10))),this.tax=0}ngOnInit(){""!=this.id&&this.getEstimate(),this.auth.currentUser.then(t=>{this.getCustomers(t),this.getProducts(t)})}addProduct(){this.productsForm=this.estimateForm.get("products"),this.productsForm.push(this.createProduct())}createProduct(){return this.fb.group({product:["",s.t.required],price:[0,s.t.required],quantity:[1,s.t.required]})}getAmount(t){return this.estimateForm.get("products").value.length?+(this.estimateForm.get("products").value[t].quantity*(this.estimateForm.get("products").value[t].price*+("1."+this.tax.toString()))).toFixed(2):0}getPricesAmount(){if(this.estimateForm.get("products").value.length){let t=0;return this.estimateForm.get("products").value.forEach(e=>{t+=e.quantity*e.price}),+t.toFixed(2)}return 0}getTaxesAmount(){if(this.estimateForm.get("products").value.length){let t=0;return this.estimateForm.get("products").value.forEach(e=>{t+=e.quantity*(e.price*+("0."+this.tax.toString()))}),+t.toFixed(2)}return 0}getTotalAmount(){if(this.estimateForm.get("products").value.length){let t=0;return this.estimateForm.get("products").value.forEach(e=>{t+=e.quantity*(e.price*+("1."+this.tax.toString()))}),+t.toFixed(2)}return 0}selectedProduct(t,e){e.patchValue({price:t.item.price}),this.tax=t.item.taxable}submitEstimate(t){this.auth.currentUser.then(e=>{var r,a,i,o,c,s;let b=new d({id:"",amount:this.getTotalAmount(),customer:null===(r=t.get("customer"))||void 0===r?void 0:r.value,estimateDate:null===(a=t.get("fromDate"))||void 0===a?void 0:a.value,expiryDate:null===(i=t.get("toDate"))||void 0===i?void 0:i.value,number:null===(o=t.get("number"))||void 0===o?void 0:o.value,ownerId:e.uid,products:null===(c=t.get("products"))||void 0===c?void 0:c.value,refNumber:null===(s=t.get("refNumber"))||void 0===s?void 0:s.value,status:"Sent"});""==this.id?this.firestoreService.createEstimate(b).then(()=>{this.toastr.success("Estimate added"),this.activeModal.close()},t=>{console.error("Something went wrong to register estimate: ",t)}):this.firestoreService.updateEstimate(this.id,b).then(()=>{this.toastr.success("Changes saved"),this.activeModal.close()},t=>{console.error("Something went wrong to update estimate: ",t)})})}removeProduct(t){this.estimateForm.get("products").removeAt(t)}getCustomers(t){this.firestoreService.getCustomers().subscribe(e=>{this.customers=[],e.forEach(e=>{e.payload.doc.data().ownerId===t.uid&&this.customers.push({id:e.payload.doc.id,amountDue:e.payload.doc.data().amountDue,billing:e.payload.doc.data().billing,contactName:e.payload.doc.data().contactName,currency:e.payload.doc.data().currency,email:e.payload.doc.data().email,img:e.payload.doc.data().img,name:e.payload.doc.data().name,ownerId:e.payload.doc.data().ownerId,phone:e.payload.doc.data().phone,registeredOn:e.payload.doc.data().registeredOn,role:e.payload.doc.data().role,shipping:e.payload.doc.data().shipping,status:e.payload.doc.data().status,website:e.payload.doc.data().website})})},t=>{console.error("Something went wrong getting customers: ",t)})}getEstimate(){let t=!0;this.removeProduct(0),this.firestoreService.getEstimate(this.id).subscribe(e=>{t&&(this.estimateForm.patchValue({customer:e.payload.data().customer,fromDate:e.payload.data().estimateDate,number:e.payload.data().number,refNumber:e.payload.data().refNumber,toDate:e.payload.data().expiryDate}),this.customer=e.payload.data().customer,e.payload.data().products.forEach(t=>{this.productsForm=this.estimateForm.get("products"),this.productsForm.push(this.fb.group({product:t.product,price:t.price,quantity:t.quantity})),this.tax=t.product.taxable}),t=!1)})}getProducts(t){this.firestoreService.getProducts().subscribe(e=>{this.products=[],e.forEach(e=>{e.payload.doc.data().ownerId===t.uid&&this.products.push({id:e.payload.doc.id,description:e.payload.doc.data().description,name:e.payload.doc.data().name,ownerId:e.payload.doc.data().ownerId,price:e.payload.doc.data().price,quantity:e.payload.doc.data().quantity,taxable:e.payload.doc.data().taxable})})},t=>{console.error("Something went wrong getting products: ",t)})}}return t.\u0275fac=function(e){return new(e||t)(l.Pb(i.a),l.Pb(p.a),l.Pb(s.e),l.Pb(h.a),l.Pb(b.b))},t.\u0275cmp=l.Jb({type:t,selectors:[["app-add-estimates"]],inputs:{id:"id"},features:[l.Cb([b.b])],decls:86,vars:9,consts:[[1,"modal-header"],[1,"content","container-fluid"],[1,"row"],[1,"col-md-12"],[1,"card"],[1,"card-body"],[3,"formGroup"],[1,"col-md-4"],[1,"form-group"],["width","100%","formControlName","customer",1,"form-control",3,"ngModel","ngModelChange"],["value","","selected",""],[3,"value",4,"ngIf"],[3,"ngValue",4,"ngFor","ngForOf"],["type","date","formControlName","fromDate","required","",1,"form-control","datetimepicker"],["type","date","formControlName","toDate","required","",1,"form-control","datetimepicker"],[1,"col-md-4","mt-3"],["id","number","name","number","formControlName","number","type","text","required","",1,"form-control"],["id","refNumber","name","refNumber","formControlName","refNumber","type","text","required","",1,"form-control"],[1,"table-responsive","mt-4"],[1,"table","table-stripped","table-center","table-hover"],["formArrayName","products",4,"ngFor","ngForOf"],[1,"text-right"],[1,"text-right","mt-4"],["type","button",1,"btn","btn-primary",3,"disabled","click"],[3,"value"],[3,"ngValue"],["formArrayName","products"],[3,"formGroupName"],["type","text","formControlName","product",1,"form-control",3,"resultFormatter","inputFormatter","ngbTypeahead","selectItem"],["formControlName","quantity","type","text","required","",1,"form-control"],["formControlName","price","type","text","required","",1,"form-control"],["type","text","required","","disabled","",1,"form-control",3,"value"],[1,"add-remove","text-right"],[1,"fas","fa-plus-circle",3,"click"],["class","fas fa-minus-circle",3,"click",4,"ngIf"],[1,"fas","fa-minus-circle",3,"click"]],template:function(t,e){1&t&&(l.Ub(0,"div",0),l.Ub(1,"div",1),l.Ub(2,"div",2),l.Ub(3,"div",3),l.Ub(4,"div",4),l.Ub(5,"div",5),l.Ub(6,"form",6),l.Ub(7,"div",2),l.Ub(8,"div",7),l.Ub(9,"div",8),l.Ub(10,"label"),l.Dc(11,"Customer:"),l.Tb(),l.Ub(12,"select",9),l.ec("ngModelChange",function(t){return e.customer=t}),l.Ub(13,"option",10),l.Dc(14,"Select Customer"),l.Tb(),l.Bc(15,f,2,2,"option",11),l.Bc(16,g,2,2,"option",12),l.Tb(),l.Tb(),l.Tb(),l.Ub(17,"div",7),l.Ub(18,"div",8),l.Ub(19,"label"),l.Dc(20,"From"),l.Tb(),l.Qb(21,"input",13),l.Tb(),l.Tb(),l.Ub(22,"div",7),l.Ub(23,"div",8),l.Ub(24,"label"),l.Dc(25,"To"),l.Tb(),l.Qb(26,"input",14),l.Tb(),l.Tb(),l.Ub(27,"div",15),l.Ub(28,"div",8),l.Ub(29,"label"),l.Dc(30,"Estimate Number"),l.Tb(),l.Qb(31,"input",16),l.Tb(),l.Tb(),l.Ub(32,"div",15),l.Ub(33,"div",8),l.Ub(34,"label"),l.Dc(35,"Ref Number"),l.Tb(),l.Qb(36,"input",17),l.Tb(),l.Tb(),l.Tb(),l.Ub(37,"div",18),l.Ub(38,"table",19),l.Ub(39,"thead"),l.Ub(40,"tr"),l.Ub(41,"th"),l.Dc(42,"Items"),l.Tb(),l.Ub(43,"th"),l.Dc(44,"Quantity"),l.Tb(),l.Ub(45,"th"),l.Dc(46,"Price"),l.Tb(),l.Ub(47,"th"),l.Dc(48,"Tax"),l.Tb(),l.Ub(49,"th"),l.Dc(50,"Amount"),l.Tb(),l.Ub(51,"th"),l.Dc(52,"Actions"),l.Tb(),l.Tb(),l.Tb(),l.Ub(53,"tbody"),l.Bc(54,T,15,7,"tr",20),l.Tb(),l.Tb(),l.Tb(),l.Ub(55,"div",18),l.Ub(56,"table",19),l.Qb(57,"thead"),l.Ub(58,"tbody"),l.Ub(59,"tr"),l.Qb(60,"td"),l.Qb(61,"td"),l.Qb(62,"td"),l.Ub(63,"td",21),l.Dc(64,"Sub Total"),l.Tb(),l.Ub(65,"td",21),l.Dc(66),l.Tb(),l.Tb(),l.Ub(67,"tr"),l.Qb(68,"td"),l.Qb(69,"td"),l.Qb(70,"td"),l.Ub(71,"td",21),l.Dc(72,"Taxes"),l.Tb(),l.Ub(73,"td",21),l.Dc(74),l.Tb(),l.Tb(),l.Ub(75,"tr"),l.Qb(76,"td"),l.Qb(77,"td"),l.Qb(78,"td"),l.Ub(79,"td",21),l.Dc(80,"Total"),l.Tb(),l.Ub(81,"td",21),l.Dc(82),l.Tb(),l.Tb(),l.Tb(),l.Tb(),l.Tb(),l.Ub(83,"div",22),l.Ub(84,"button",23),l.ec("click",function(){return e.submitEstimate(e.estimateForm)}),l.Dc(85," Add Estimate "),l.Tb(),l.Tb(),l.Tb(),l.Tb(),l.Tb(),l.Tb(),l.Tb(),l.Tb(),l.Tb()),2&t&&(l.Db(6),l.mc("formGroup",e.estimateForm),l.Db(6),l.mc("ngModel",e.customer),l.Db(3),l.mc("ngIf",""!=e.id),l.Db(1),l.mc("ngForOf",e.customers),l.Db(38),l.mc("ngForOf",e.estimateForm.get("products").controls),l.Db(12),l.Fc("$ ",e.getPricesAmount(),""),l.Db(8),l.Fc("$ ",e.getTaxesAmount(),""),l.Db(8),l.Fc("$ ",e.getTotalAmount(),""),l.Db(2),l.mc("disabled",!e.estimateForm.valid))},directives:[s.v,s.m,s.g,s.s,s.l,s.f,s.p,s.u,a.l,a.k,s.c,s.r,s.d,s.h,i.e],encapsulation:2}),t})();var D=r("bE4C");function y(t,e){if(1&t&&(l.Ub(0,"div",19),l.Sb(1,20),l.Qb(2,"input",21),l.Rb(),l.Tb()),2&t){const t=e.index;l.Db(1),l.mc("formGroupName",t)}}let F=(()=>{class t{constructor(t,e,r,a,i){this.activeModal=t,this.auth=e,this.fb=r,this.firestoreService=a,this.toastr=i,this.currentUser="",this.sendForm=this.fb.group({from:["",s.t.required],emails:this.fb.array([this.createEmail()]),subject:["",s.t.required],message:["",s.t.required],sendToMe:[!1],attachPDF:[!1]}),this.emailsForm=this.fb.array([])}ngOnInit(){this.auth.currentUser.then(t=>{this.currentUser=t}),""!=this.id&&this.getEstimate()}addEmail(){this.emailsForm=this.sendForm.get("emails"),this.emailsForm.push(this.createEmail())}createEmail(){return this.fb.group({email:["",s.t.required]})}removeEmail(t){this.sendForm.get("emails").removeAt(t)}submitProduct(t){this.auth.currentUser.then(e=>{var r,a,i;let o=new D.a({id:"",description:null===(r=t.get("description"))||void 0===r?void 0:r.value,name:null===(a=t.get("name"))||void 0===a?void 0:a.value,ownerId:e.uid,price:null===(i=t.get("price"))||void 0===i?void 0:i.value,quantity:1,taxable:16});""==this.id?this.firestoreService.createProduct(o).then(()=>{this.toastr.success("Product added"),this.activeModal.close()}).catch(t=>{console.error("Something went wront creating a product: ",t)}):this.firestoreService.updateProduct(this.id,o).then(()=>{this.toastr.success("Changes saved"),this.activeModal.close()},t=>{console.error("Something went wrong: ",t)})})}getEstimate(){this.firestoreService.getEstimate(this.id).subscribe(t=>{this.sendForm.patchValue({from:this.currentUser.email,subject:"Estimate #"+t.payload.data().number+" from Axented"})})}}return t.\u0275fac=function(e){return new(e||t)(l.Pb(i.a),l.Pb(p.a),l.Pb(s.e),l.Pb(h.a),l.Pb(b.b))},t.\u0275cmp=l.Jb({type:t,selectors:[["app-send-estimate"]],inputs:{id:"id"},features:[l.Cb([b.b])],decls:40,vars:4,consts:[[1,"modal-header"],[1,"content","container-fluid"],[1,"row"],[1,"col-md-12"],[1,"card"],[1,"card-body"],[1,"card-title","mt-4"],[3,"formGroup"],[1,"form-group"],["id","from","name","from","formControlName","from","type","text","required","",1,"form-control"],[1,"label"],[1,"fas","fa-plus-circle",3,"click"],["formArrayName","emails",4,"ngFor","ngForOf"],["id","subject","name","subject","formControlName","subject","type","text","required","",1,"form-control"],["rows","5","cols","5","placeholder","Enter Message","formControlName","message",1,"form-control"],["id","sendToMe","name","sendToMe","formControlName","sendToMe","type","checkbox","required","",1,"form-control-checkbox"],["id","attachPDF","name","attachPDF","formControlName","attachPDF","type","checkbox","required","",1,"form-control-checkbox"],[1,"text-right","mt-4"],["type","button",1,"btn","btn-primary",3,"disabled","click"],["formArrayName","emails"],[3,"formGroupName"],["formControlName","email","type","text","required","",1,"form-control"]],template:function(t,e){1&t&&(l.Ub(0,"div",0),l.Ub(1,"div",1),l.Ub(2,"div",2),l.Ub(3,"div",3),l.Ub(4,"div",4),l.Ub(5,"div",5),l.Ub(6,"h4",6),l.Dc(7,"Send this estimate"),l.Tb(),l.Ub(8,"form",7),l.Ub(9,"div",2),l.Ub(10,"div",3),l.Ub(11,"div",8),l.Ub(12,"label"),l.Dc(13,"From"),l.Tb(),l.Qb(14,"input",9),l.Tb(),l.Ub(15,"div",8),l.Ub(16,"label",10),l.Dc(17,"To"),l.Tb(),l.Ub(18,"i",11),l.ec("click",function(){return e.addEmail()}),l.Tb(),l.Bc(19,y,3,1,"div",12),l.Tb(),l.Ub(20,"div",8),l.Ub(21,"label"),l.Dc(22,"Subject"),l.Tb(),l.Qb(23,"input",13),l.Tb(),l.Ub(24,"div",8),l.Ub(25,"label"),l.Dc(26,"Message"),l.Tb(),l.Ub(27,"textarea",14),l.Dc(28,"\t\t\t\t\t\t\t\t\t\t"),l.Tb(),l.Tb(),l.Ub(29,"div",8),l.Qb(30,"input",15),l.Ub(31,"label"),l.Dc(32),l.Tb(),l.Tb(),l.Ub(33,"div",8),l.Qb(34,"input",16),l.Ub(35,"label"),l.Dc(36,"Attach the estimate as a PDF"),l.Tb(),l.Tb(),l.Tb(),l.Tb(),l.Ub(37,"div",17),l.Ub(38,"button",18),l.ec("click",function(){return e.submitProduct(e.sendForm)}),l.Dc(39," Send "),l.Tb(),l.Tb(),l.Tb(),l.Tb(),l.Tb(),l.Tb(),l.Tb(),l.Tb(),l.Tb()),2&t&&(l.Db(8),l.mc("formGroup",e.sendForm),l.Db(11),l.mc("ngForOf",e.sendForm.get("emails").controls),l.Db(13),l.Fc("Send a copy to myself at ",e.sendForm.get("from").value,""),l.Db(6),l.mc("disabled",!e.sendForm.valid))},directives:[s.v,s.m,s.g,s.c,s.l,s.f,s.r,a.k,s.a,s.b,s.d,s.h],styles:[".form-control-checkbox[_ngcontent-%COMP%]{width:16px;height:16px;margin-right:8px}.label[_ngcontent-%COMP%]{margin-right:8px}i[_ngcontent-%COMP%]{cursor:pointer}"]}),t})();var w=r("eSIH");function x(t,e){if(1&t&&(l.Ub(0,"a",8),l.Qb(1,"img",57),l.Dc(2),l.Tb()),2&t){const t=l.gc().$implicit;l.mc("routerLink","/profile"),l.Db(1),l.nc("src",t.customer.img,l.xc),l.Db(1),l.Ec(t.customer.name)}}function E(t,e){if(1&t&&(l.Ub(0,"span",58),l.Dc(1),l.Tb()),2&t){const t=l.gc().$implicit;l.Db(1),l.Ec(t.status)}}function S(t,e){if(1&t&&(l.Ub(0,"span",59),l.Dc(1),l.Tb()),2&t){const t=l.gc().$implicit;l.Db(1),l.Ec(t.status)}}function P(t,e){if(1&t&&(l.Ub(0,"span",60),l.Dc(1),l.Tb()),2&t){const t=l.gc().$implicit;l.Db(1),l.Ec(t.status)}}function N(t,e){if(1&t&&(l.Ub(0,"span",61),l.Dc(1),l.Tb()),2&t){const t=l.gc().$implicit;l.Db(1),l.Ec(t.status)}}function k(t,e){if(1&t){const t=l.Vb();l.Ub(0,"tr"),l.Ub(1,"td"),l.Ub(2,"a",8),l.Dc(3),l.Tb(),l.Tb(),l.Ub(4,"td"),l.Ub(5,"h2",39),l.Bc(6,x,3,3,"a",40),l.Tb(),l.Tb(),l.Ub(7,"td"),l.Dc(8),l.hc(9,"date"),l.Tb(),l.Ub(10,"td"),l.Dc(11),l.hc(12,"date"),l.Tb(),l.Ub(13,"td"),l.Dc(14),l.Tb(),l.Ub(15,"td"),l.Bc(16,E,2,1,"span",41),l.Bc(17,S,2,1,"span",42),l.Bc(18,P,2,1,"span",43),l.Bc(19,N,2,1,"span",44),l.Tb(),l.Ub(20,"td",37),l.Ub(21,"div",45),l.Ub(22,"a",46),l.Qb(23,"i",47),l.Tb(),l.Ub(24,"div",48),l.Ub(25,"a",49),l.ec("click",function(){l.vc(t);const r=e.$implicit;return l.gc().openEstimateModal(r.id)}),l.Qb(26,"i",50),l.Dc(27,"Edit"),l.Tb(),l.Ub(28,"a",49),l.ec("click",function(){l.vc(t);const r=e.$implicit;return l.gc().deleteEstimate(r)}),l.Qb(29,"i",51),l.Dc(30,"Delete"),l.Tb(),l.Ub(31,"a",52),l.Qb(32,"i",53),l.Dc(33,"Convert to Invoice"),l.Tb(),l.Ub(34,"a",52),l.Qb(35,"i",54),l.Dc(36,"Mark as sent"),l.Tb(),l.Ub(37,"a",49),l.ec("click",function(){l.vc(t);const r=e.$implicit;return l.gc().sendEstimateModal(r.id)}),l.Qb(38,"i",55),l.Dc(39,"Send Estimate"),l.Tb(),l.Ub(40,"a",52),l.Qb(41,"i",54),l.Dc(42,"Mark as Accepted"),l.Tb(),l.Ub(43,"a",52),l.Qb(44,"i",56),l.Dc(45,"Mark as Rejected"),l.Tb(),l.Tb(),l.Tb(),l.Tb(),l.Tb()}if(2&t){const t=e.$implicit;l.Db(2),l.mc("routerLink","/view-estimate"),l.Db(1),l.Ec(t.number),l.Db(3),l.mc("ngIf",t.customer),l.Db(2),l.Ec(l.jc(9,10,t.estimateDate,"dd MMM yyyy")),l.Db(3),l.Ec(l.jc(12,13,t.expiryDate,"dd MMM yyyy")),l.Db(3),l.Fc("$ ",t.amount,""),l.Db(2),l.mc("ngIf","Accepted"===t.status),l.Db(1),l.mc("ngIf","Declined"===t.status),l.Db(1),l.mc("ngIf","Sent"===t.status),l.Db(1),l.mc("ngIf","Expired"===t.status)}}const M=[{path:"",component:(()=>{class t{constructor(t,e,r){this.auth=t,this.firestoreService=e,this.modalService=r,this.estimates=[]}ngOnInit(){this.auth.currentUser.then(t=>{this.getEstimates(t)})}deleteEstimate(t){this.firestoreService.deleteEstimate(t.id)}openEstimateModal(t){this.modalService.open(U,{animation:!0,size:"lg"}).componentInstance.id=t}sendEstimateModal(t){this.modalService.open(F,{animation:!0,size:"md"}).componentInstance.id=t}getEstimates(t){this.firestoreService.getEstimates().subscribe(e=>{this.estimates=[],e.forEach(e=>{e.payload.doc.data().ownerId===t.uid&&this.estimates.push({id:e.payload.doc.id,amount:e.payload.doc.data().amount,customer:e.payload.doc.data().customer,estimateDate:e.payload.doc.data().estimateDate,expiryDate:e.payload.doc.data().expiryDate,number:e.payload.doc.data().number,ownerId:e.payload.doc.data().ownerId,products:e.payload.doc.data().products,refNumber:e.payload.doc.data().refNumber,status:e.payload.doc.data().status})})},t=>{console.error("Something went wrong getting estimates: ",t)})}}return t.\u0275fac=function(e){return new(e||t)(l.Pb(p.a),l.Pb(h.a),l.Pb(i.c))},t.\u0275cmp=l.Jb({type:t,selectors:[["app-estimates"]],decls:86,vars:2,consts:[[1,"page-wrapper"],[1,"content","container-fluid"],[1,"page-header"],[1,"row","align-items-center"],[1,"col"],[1,"page-title"],[1,"breadcrumb"],[1,"breadcrumb-item"],[3,"routerLink"],[1,"breadcrumb-item","active"],[1,"col-auto"],["href","javascript:void(0)",1,"btn","btn-primary","mr-1",3,"click"],[1,"fas","fa-plus"],["href","javascript:void(0);","id","filter_search",1,"btn","btn-primary","filter-btn"],[1,"fas","fa-filter"],["id","filter_inputs",1,"card","filter-card"],[1,"card-body","pb-0"],[1,"row"],[1,"col-md-3"],[1,"form-group"],["type","text",1,"form-control"],[1,"col-md-2"],["width","100%"],["value","Draft"],["value","Sent"],["value","Viewed"],["value","Expired"],["value","Accepted"],["value","Rejected"],[1,"cal-icon"],["type","text",1,"form-control","datetimepicker"],[1,"col-sm-12"],[1,"card","card-table"],[1,"card-body"],[1,"table-responsive"],[1,"table","table-stripped","table-hover","datatable"],[1,"thead-light"],[1,"text-right"],[4,"ngFor","ngForOf"],[1,"table-avatar"],[3,"routerLink",4,"ngIf"],["class","badge bg-success-light",4,"ngIf"],["class","badge bg-danger-light",4,"ngIf"],["class","badge bg-info-light",4,"ngIf"],["class","badge bg-warning-light",4,"ngIf"],[1,"dropdown","dropdown-action"],["href","javascript:void(0)","data-toggle","dropdown","aria-expanded","false",1,"action-icon","dropdown-toggle"],[1,"fas","fa-ellipsis-h"],[1,"dropdown-menu","dropdown-menu-right"],["href","javascript:void(0);",1,"dropdown-item",3,"click"],[1,"far","fa-edit","mr-2"],[1,"far","fa-trash-alt","mr-2"],["href","javascript:void(0);",1,"dropdown-item"],[1,"far","fa-file-alt","mr-2"],[1,"far","fa-check-circle","mr-2"],[1,"far","fa-paper-plane","mr-2"],[1,"far","fa-times-circle","mr-2"],["alt","User Image",1,"avatar","avatar-sm","mr-2","avatar-img","rounded-circle",3,"src"],[1,"badge","bg-success-light"],[1,"badge","bg-danger-light"],[1,"badge","bg-info-light"],[1,"badge","bg-warning-light"]],template:function(t,e){1&t&&(l.Ub(0,"div",0),l.Ub(1,"div",1),l.Ub(2,"div",2),l.Ub(3,"div",3),l.Ub(4,"div",4),l.Ub(5,"h3",5),l.Dc(6,"Estimates"),l.Tb(),l.Ub(7,"ul",6),l.Ub(8,"li",7),l.Ub(9,"a",8),l.Dc(10,"Dashboard"),l.Tb(),l.Tb(),l.Ub(11,"li",9),l.Dc(12,"Estimates"),l.Tb(),l.Tb(),l.Tb(),l.Ub(13,"div",10),l.Ub(14,"a",11),l.ec("click",function(){return e.openEstimateModal("")}),l.Qb(15,"i",12),l.Tb(),l.Ub(16,"a",13),l.Qb(17,"i",14),l.Tb(),l.Tb(),l.Tb(),l.Tb(),l.Ub(18,"div",15),l.Ub(19,"div",16),l.Ub(20,"div",17),l.Ub(21,"div",18),l.Ub(22,"div",19),l.Ub(23,"label"),l.Dc(24,"Customer:"),l.Tb(),l.Qb(25,"input",20),l.Tb(),l.Tb(),l.Ub(26,"div",21),l.Ub(27,"div",19),l.Ub(28,"label"),l.Dc(29,"Status:"),l.Tb(),l.Ub(30,"ng-select2",22),l.Ub(31,"option"),l.Dc(32,"Select Status"),l.Tb(),l.Ub(33,"option",23),l.Dc(34,"Draft"),l.Tb(),l.Ub(35,"option",24),l.Dc(36,"Sent"),l.Tb(),l.Ub(37,"option",25),l.Dc(38,"Viewed"),l.Tb(),l.Ub(39,"option",26),l.Dc(40,"Expired"),l.Tb(),l.Ub(41,"option",27),l.Dc(42,"Accepted"),l.Tb(),l.Ub(43,"option",28),l.Dc(44,"Rejected"),l.Tb(),l.Tb(),l.Tb(),l.Tb(),l.Ub(45,"div",21),l.Ub(46,"div",19),l.Ub(47,"label"),l.Dc(48,"From"),l.Tb(),l.Ub(49,"div",29),l.Qb(50,"input",30),l.Tb(),l.Tb(),l.Tb(),l.Ub(51,"div",21),l.Ub(52,"div",19),l.Ub(53,"label"),l.Dc(54,"To"),l.Tb(),l.Ub(55,"div",29),l.Qb(56,"input",30),l.Tb(),l.Tb(),l.Tb(),l.Ub(57,"div",18),l.Ub(58,"div",19),l.Ub(59,"label"),l.Dc(60,"Estimate Number"),l.Tb(),l.Qb(61,"input",20),l.Tb(),l.Tb(),l.Tb(),l.Tb(),l.Tb(),l.Ub(62,"div",17),l.Ub(63,"div",31),l.Ub(64,"div",32),l.Ub(65,"div",33),l.Ub(66,"div",34),l.Ub(67,"table",35),l.Ub(68,"thead",36),l.Ub(69,"tr"),l.Ub(70,"th"),l.Dc(71,"Estimate Number"),l.Tb(),l.Ub(72,"th"),l.Dc(73,"Customer"),l.Tb(),l.Ub(74,"th"),l.Dc(75,"Estimate Date"),l.Tb(),l.Ub(76,"th"),l.Dc(77,"Expiry Date"),l.Tb(),l.Ub(78,"th"),l.Dc(79,"Amount"),l.Tb(),l.Ub(80,"th"),l.Dc(81,"Status"),l.Tb(),l.Ub(82,"th",37),l.Dc(83,"Action"),l.Tb(),l.Tb(),l.Tb(),l.Ub(84,"tbody"),l.Bc(85,k,46,16,"tr",38),l.Tb(),l.Tb(),l.Tb(),l.Tb(),l.Tb(),l.Tb(),l.Tb(),l.Tb(),l.Tb()),2&t&&(l.Db(9),l.mc("routerLink",""),l.Db(76),l.mc("ngForOf",e.estimates))},directives:[c.d,w.a,s.p,s.u,a.k,a.l],pipes:[a.d],styles:[""]}),t})()}];let I=(()=>{class t{}return t.\u0275mod=l.Nb({type:t}),t.\u0275inj=l.Mb({factory:function(e){return new(e||t)},imports:[[c.e.forChild(M)],c.e]}),t})(),Q=(()=>{class t{}return t.\u0275mod=l.Nb({type:t}),t.\u0275inj=l.Mb({factory:function(e){return new(e||t)},imports:[[a.b,I,w.b,i.d,o.a,s.i,s.q,b.a.forRoot({positionClass:"toast-bottom-right"})]]}),t})()}}]);